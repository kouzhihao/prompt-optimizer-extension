<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Optimizer</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- 顶部工具栏 -->
    <header class="toolbar">
      <div class="toolbar-left">
        <h1 class="app-title">
          <svg class="logo-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
          </svg>
          提示词优化器
        </h1>
      </div>
      <div class="toolbar-right">
        <button id="newChatBtn" class="btn btn-secondary" title="开始新对话">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          新对话
        </button>
        <button id="settingsBtn" class="btn btn-icon" title="设置">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- 配置引导页 -->
    <div id="configGuide" class="config-guide hidden">
      <div class="guide-content">
        <svg class="guide-icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <path d="M12 16v-4m0-4h.01"/>
        </svg>
        <h2>欢迎使用提示词优化器</h2>
        <p>在开始之前,请先配置 AI 服务</p>
        <button id="startConfigBtn" class="btn btn-primary btn-large">开始配置</button>
      </div>
    </div>

    <!-- 主对话区 -->
    <main id="mainContent" class="main-content">
      <div id="chatContainer" class="chat-container">
        <!-- 欢迎消息 -->
        <div class="welcome-message">
          <h2>👋 您好!</h2>
          <p>我是您的提示词优化助手,基于 57 个成熟的提示词框架帮您生成高质量的 AI 提示词。</p>
          <p>请描述您的需求,我会为您推荐最合适的框架并帮您优化提示词。</p>
        </div>
      </div>

      <!-- 框架推荐区 -->
      <div id="frameworksContainer" class="frameworks-container hidden"></div>

      <!-- 生成结果区 -->
      <div id="resultContainer" class="result-container hidden"></div>
    </main>

    <!-- 输入区 -->
    <footer class="input-area">
      <div class="input-wrapper">
        <textarea 
          id="userInput" 
          class="input-field" 
          placeholder="请描述您的需求..."
          rows="3"
        ></textarea>
        <button id="sendBtn" class="btn btn-primary btn-send">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
          </svg>
        </button>
      </div>
      <div class="input-hint">
        按 Shift+Enter 换行,Enter 发送
      </div>
    </footer>
  </div>

  <!-- 配置对话框 -->
  <div id="settingsModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>配置 AI 服务</h2>
        <button class="modal-close" id="closeSettingsBtn">×</button>
      </div>
      <div class="modal-body">
        <!-- 服务选择 -->
        <div class="form-group">
          <label for="activeService" class="form-label">当前使用的服务</label>
          <select id="activeService" class="form-input form-select">
            <option value="deepseek">DeepSeek</option>
            <option value="kimi">Kimi</option>
            <option value="openrouter">OpenRouter</option>
            <option value="custom">OpenAI 兼容</option>
          </select>
        </div>

        <!-- DeepSeek 配置 -->
        <div class="service-config" id="deepseekConfig">
          <h3 class="config-title">DeepSeek 配置</h3>
          <div class="form-group">
            <label for="deepseekApiKey" class="form-label">API Key</label>
            <input type="password" id="deepseekApiKey" class="form-input" placeholder="sk-...">
          </div>
          <div class="form-group">
            <label for="deepseekModel" class="form-label">模型</label>
            <input type="text" id="deepseekModel" class="form-input" placeholder="deepseek-chat">
          </div>
        </div>

        <!-- Kimi 配置 -->
        <div class="service-config" id="kimiConfig">
          <h3 class="config-title">Kimi 配置</h3>
          <div class="form-group">
            <label for="kimiApiKey" class="form-label">API Key</label>
            <input type="password" id="kimiApiKey" class="form-input" placeholder="sk-...">
          </div>
          <div class="form-group">
            <label for="kimiModel" class="form-label">模型</label>
            <input type="text" id="kimiModel" class="form-input" placeholder="kimi-k2-turbo-preview">
          </div>
        </div>

        <!-- OpenRouter 配置 -->
        <div class="service-config" id="openrouterConfig">
          <h3 class="config-title">OpenRouter 配置</h3>
          <div class="form-group">
            <label for="openrouterApiKey" class="form-label">API Key</label>
            <input type="password" id="openrouterApiKey" class="form-input" placeholder="sk-...">
          </div>
          <div class="form-group">
            <label for="openrouterModel" class="form-label">模型</label>
            <input type="text" id="openrouterModel" class="form-input" placeholder="anthropic/claude-3.5-sonnet">
          </div>
        </div>

        <!-- OpenAI 兼容服务配置 -->
        <div class="service-config" id="customConfig">
          <h3 class="config-title">OpenAI 兼容服务配置</h3>
          <div class="form-group">
            <label for="customEndpoint" class="form-label">API URL</label>
            <input type="text" id="customEndpoint" class="form-input" placeholder="https://api.example.com/v1/chat/completions">
          </div>
          <div class="form-group">
            <label for="customApiKey" class="form-label">API Key</label>
            <input type="password" id="customApiKey" class="form-input" placeholder="sk-...">
          </div>
          <div class="form-group">
            <label for="customModel" class="form-label">模型名称</label>
            <input type="text" id="customModel" class="form-input" placeholder="gpt-4o">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="testConfigBtn" class="btn btn-secondary">测试连接</button>
        <button id="saveConfigBtn" class="btn btn-primary">保存配置</button>
      </div>
    </div>
  </div>

  <!-- 加载提示 -->
  <div id="loadingOverlay" class="loading-overlay hidden">
    <div class="loading-spinner"></div>
    <p class="loading-text">处理中...</p>
  </div>

  <!-- Toast 提示 -->
  <div id="toast" class="toast hidden"></div>

  <!-- 引入脚本 -->
  <script src="../lib/storage-manager.js"></script>
  <script src="../lib/ai-service.js"></script>
  <script src="../lib/framework-engine.js"></script>
  <script src="app.js"></script>
</body>
</html>
